import{h as se,k as dt,l as ct,m as mt,Q as M,c as Je,R as ft,f as vt,b as pt,e as gt}from"./QBtn.1106fff4.js";import{o as xe,d as F,c as Ye,a as j,q as ht,w as bt,g as Re,s as yt,b as wt,u as xt,e as kt}from"./firebase.b163514c.js";import{d as _t,c as Ct,h as qt,Q as ae}from"./scroll.a8da4cf4.js";import{Q as ke,a as Vt,b as _e,u as Tt,c as Rt}from"./QInput.7956ab7a.js";import{m as ie,A as b,n as V,P as Xe,ab as Pe,ac as P,U as D,Q as Ce,ad as St,J as Ge,t as w,Y as qe,T as Me,B as Ze,I as Et,o as J,p as _,q as E,w as y,x as c,a1 as S,H as A,u as et,v as tt,a8 as ot,a0 as $,z as De,a3 as K,a2 as he,a4 as Lt,y as Ve,ae as Bt,af as U,ag as Ie,aa as $t}from"./index.b7c3ad49.js";import{u as Pt,a as Mt,b as Dt,c as It,d as Ft,e as Qt,f as zt,g as At,h as Ht,i as Ot,O as Ut}from"./OverlappingAvatars.99c714a4.js";import{a as jt,u as Kt,b as Nt}from"./room.b814678f.js";import{Q as ne}from"./QCardSection.93ca20b2.js";import{Q as Se}from"./QCard.1be5af88.js";import{c as Fe,b as Wt,a as Jt}from"./auth.3820e33c.js";var Te=ie({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:o}){const t=b(()=>`q-item__section column q-item__section--${e.avatar===!0||e.side===!0||e.thumbnail===!0?"side":"main"}`+(e.top===!0?" q-item__section--top justify-start":" justify-center")+(e.avatar===!0?" q-item__section--avatar":"")+(e.thumbnail===!0?" q-item__section--thumbnail":"")+(e.noWrap===!0?" q-item__section--nowrap":""));return()=>V("div",{class:t.value},se(o.default))}}),Ee=ie({name:"QCardActions",props:{...dt,vertical:Boolean},setup(e,{slots:o}){const t=ct(e),l=b(()=>`q-card__actions ${t.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>V("div",{class:l.value},se(o.default))}});function Yt(e,o,t){let l;function n(){l!==void 0&&(Pe.remove(l),l=void 0)}return Xe(()=>{e.value===!0&&n()}),{removeFromHistory:n,addToHistory(){l={condition:()=>t.value===!0,handler:o},Pe.add(l)}}}let G=0,be,ye,Z,we=!1,Qe,ze,Ae,I=null;function Xt(e){Gt(e)&&Ce(e)}function Gt(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const o=St(e),t=e.shiftKey&&!e.deltaX,l=!t&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),n=t||l?e.deltaY:e.deltaX;for(let s=0;s<o.length;s++){const a=o[s];if(qt(a,l))return l?n<0&&a.scrollTop===0?!0:n>0&&a.scrollTop+a.clientHeight===a.scrollHeight:n<0&&a.scrollLeft===0?!0:n>0&&a.scrollLeft+a.clientWidth===a.scrollWidth}return!0}function He(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function oe(e){we!==!0&&(we=!0,requestAnimationFrame(()=>{we=!1;const{height:o}=e.target,{clientHeight:t,scrollTop:l}=document.scrollingElement;(Z===void 0||o!==window.innerHeight)&&(Z=t-o,document.scrollingElement.scrollTop=l),l>Z&&(document.scrollingElement.scrollTop-=Math.ceil((l-Z)/8))}))}function Oe(e){const o=document.body,t=window.visualViewport!==void 0;if(e==="add"){const{overflowY:l,overflowX:n}=window.getComputedStyle(o);be=_t(window),ye=Ct(window),Qe=o.style.left,ze=o.style.top,Ae=window.location.href,o.style.left=`-${be}px`,o.style.top=`-${ye}px`,n!=="hidden"&&(n==="scroll"||o.scrollWidth>window.innerWidth)&&o.classList.add("q-body--force-scrollbar-x"),l!=="hidden"&&(l==="scroll"||o.scrollHeight>window.innerHeight)&&o.classList.add("q-body--force-scrollbar-y"),o.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,P.is.ios===!0&&(t===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",oe,D.passiveCapture),window.visualViewport.addEventListener("scroll",oe,D.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",He,D.passiveCapture))}P.is.desktop===!0&&P.is.mac===!0&&window[`${e}EventListener`]("wheel",Xt,D.notPassive),e==="remove"&&(P.is.ios===!0&&(t===!0?(window.visualViewport.removeEventListener("resize",oe,D.passiveCapture),window.visualViewport.removeEventListener("scroll",oe,D.passiveCapture)):window.removeEventListener("scroll",He,D.passiveCapture)),o.classList.remove("q-body--prevent-scroll"),o.classList.remove("q-body--force-scrollbar-x"),o.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,o.style.left=Qe,o.style.top=ze,window.location.href===Ae&&window.scrollTo(be,ye),Z=void 0)}function Zt(e){let o="add";if(e===!0){if(G++,I!==null){clearTimeout(I),I=null;return}if(G>1)return}else{if(G===0||(G--,G>0))return;if(o="remove",P.is.ios===!0&&P.is.nativeMobile===!0){I!==null&&clearTimeout(I),I=setTimeout(()=>{Oe(o),I=null},100);return}}Oe(o)}function eo(){let e;return{preventBodyScroll(o){o!==e&&(e!==void 0||o===!0)&&(e=o,Zt(o))}}}const Q=[];let N;function to(e){N=e.keyCode===27}function oo(){N===!0&&(N=!1)}function lo(e){N===!0&&(N=!1,Ge(e,27)===!0&&Q[Q.length-1](e))}function lt(e){window[e]("keydown",to),window[e]("blur",oo),window[e]("keyup",lo),N=!1}function ao(e){P.is.desktop===!0&&(Q.push(e),Q.length===1&&lt("addEventListener"))}function Ue(e){const o=Q.indexOf(e);o!==-1&&(Q.splice(o,1),Q.length===0&&lt("removeEventListener"))}const z=[];function at(e){z[z.length-1](e)}function no(e){P.is.desktop===!0&&(z.push(e),z.length===1&&document.body.addEventListener("focusin",at))}function je(e){const o=z.indexOf(e);o!==-1&&(z.splice(o,1),z.length===0&&document.body.removeEventListener("focusin",at))}let le=0;const so={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},Ke={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var Le=ie({name:"QDialog",inheritAttrs:!1,props:{...Pt,...Mt,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:e=>["standard","top","bottom","left","right"].includes(e)}},emits:[...Dt,"shake","click","escapeKey"],setup(e,{slots:o,emit:t,attrs:l}){const n=Ze(),s=w(null),a=w(!1),p=w(!1);let r=null,d=null,i,u;const m=b(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:q}=eo(),{registerTimeout:x}=It(),{registerTick:g,removeTick:h}=Ft(),{transitionProps:k,transitionStyle:T}=Qt(e,()=>Ke[e.position][0],()=>Ke[e.position][1]),L=b(()=>T.value+(e.backdropFilter!==void 0?`;backdrop-filter:${e.backdropFilter};-webkit-backdrop-filter:${e.backdropFilter}`:"")),{showPortal:R,hidePortal:ee,portalIsAccessible:re,renderPortal:Y}=zt(n,s,ut,"dialog"),{hide:H}=At({showing:a,hideOnRouteChange:m,handleShow:nt,handleHide:st,processOnMount:!0}),{addToHistory:ue,removeFromHistory:de}=Yt(a,H,m),ce=b(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${so[e.position]}`+(p.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),f=b(()=>a.value===!0&&e.seamless!==!0),B=b(()=>e.autoClose===!0?{onClick:it}:{}),te=b(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${f.value===!0?"modal":"seamless"}`,l.class]);qe(()=>e.maximized,v=>{a.value===!0&&ve(v)}),qe(f,v=>{q(v),v===!0?(no(pe),ao(fe)):(je(pe),Ue(fe))});function nt(v){ue(),d=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,ve(e.maximized),R(),p.value=!0,e.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),g(X)):h(),x(()=>{if(n.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:C,bottom:O}=document.activeElement.getBoundingClientRect(),{innerHeight:$e}=window,ge=window.visualViewport!==void 0?window.visualViewport.height:$e;C>0&&O>ge/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-ge,O>=$e?1/0:Math.ceil(document.scrollingElement.scrollTop+O-ge/2))),document.activeElement.scrollIntoView()}u=!0,s.value.click(),u=!1}R(!0),p.value=!1,t("show",v)},e.transitionDuration)}function st(v){h(),de(),Be(!0),p.value=!0,ee(),d!==null&&(((v&&v.type.indexOf("key")===0?d.closest('[tabindex]:not([tabindex^="-"])'):void 0)||d).focus(),d=null),x(()=>{ee(!0),p.value=!1,t("hide",v)},e.transitionDuration)}function X(v){jt(()=>{let C=s.value;if(C!==null){if(v!==void 0){const O=C.querySelector(v);if(O!==null){O.focus({preventScroll:!0});return}}C.contains(document.activeElement)!==!0&&(C=C.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||C.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||C.querySelector("[autofocus], [data-autofocus]")||C,C.focus({preventScroll:!0}))}})}function me(v){v&&typeof v.focus=="function"?v.focus({preventScroll:!0}):X(),t("shake");const C=s.value;C!==null&&(C.classList.remove("q-animate--scale"),C.classList.add("q-animate--scale"),r!==null&&clearTimeout(r),r=setTimeout(()=>{r=null,s.value!==null&&(C.classList.remove("q-animate--scale"),X())},170))}function fe(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&me():(t("escapeKey"),H()))}function Be(v){r!==null&&(clearTimeout(r),r=null),(v===!0||a.value===!0)&&(ve(!1),e.seamless!==!0&&(q(!1),je(pe),Ue(fe))),v!==!0&&(d=null)}function ve(v){v===!0?i!==!0&&(le<1&&document.body.classList.add("q-body--dialog"),le++,i=!0):i===!0&&(le<2&&document.body.classList.remove("q-body--dialog"),le--,i=!1)}function it(v){u!==!0&&(H(v),t("click",v))}function rt(v){e.persistent!==!0&&e.noBackdropDismiss!==!0?H(v):e.noShake!==!0&&me()}function pe(v){e.allowFocusOutside!==!0&&re.value===!0&&mt(s.value,v.target)!==!0&&X('[tabindex]:not([tabindex="-1"])')}Object.assign(n.proxy,{focus:X,shake:me,__updateRefocusTarget(v){d=v||null}}),Xe(Be);function ut(){return V("div",{role:"dialog","aria-modal":f.value===!0?"true":"false",...l,class:te.value},[V(Me,{name:"q-transition--fade",appear:!0},()=>f.value===!0?V("div",{class:"q-dialog__backdrop fixed-full",style:L.value,"aria-hidden":"true",tabindex:-1,onClick:rt}):null),V(Me,k.value,()=>a.value===!0?V("div",{ref:s,class:ce.value,style:T.value,tabindex:-1,...B.value},se(o.default)):null)])}return Y}});function Ne(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const o=parseInt(e,10);return isNaN(o)?0:o}var W=Et({name:"close-popup",beforeMount(e,{value:o}){const t={depth:Ne(o),handler(l){t.depth!==0&&setTimeout(()=>{const n=Ht(e);n!==void 0&&Ot(n,l,t.depth)})},handlerKey(l){Ge(l,13)===!0&&t.handler(l)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:o,oldValue:t}){o!==t&&(e.__qclosepopup.depth=Ne(o))},beforeUnmount(e){const o=e.__qclosepopup;e.removeEventListener("click",o.handler),e.removeEventListener("keyup",o.handlerKey),delete e.__qclosepopup}});const io=J({__name:"ConfirmLeaveRoomDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","confirm"],setup(e,{emit:o}){const t=e,l=o,n=b({get:()=>t.modelValue,set:s=>l("update:modelValue",s)});return(s,a)=>(_(),E(Le,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=p=>n.value=p),persistent:""},{default:y(()=>[c(Se,null,{default:y(()=>[c(ne,null,{default:y(()=>a[2]||(a[2]=[S("div",{class:"text-h6"},"Leave Room",-1)])),_:1}),c(ne,null,{default:y(()=>a[3]||(a[3]=[S("div",{class:"text-body1"},"Are you sure you want to leave this room?",-1)])),_:1}),c(Ee,{align:"right"},{default:y(()=>[A(c(M,{flat:"",label:"Cancel"},null,512),[[W]]),A(c(M,{color:"negative",label:"Leave",onClick:a[0]||(a[0]=p=>l("confirm"))},null,512),[[W]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ro={key:0},uo={key:1},co={class:"row items-center q-gutter-xs"},mo={class:"text-weight-bold"},fo={class:"text-caption text-grey"},vo={class:"row items-center justify-end"},po=J({__name:"ChatListItem",props:{id:{type:String,required:!0},maxLength:{type:Number,default:30,required:!1},icons:{type:Boolean,default:!0,required:!1}},setup(e){const o=et(),t=e,{leaveRoom:l,chatUsers:n,fetchRoomData:s}=Kt(t.id),a=w(!0),p=w();let r=null;const d=async g=>{await s(),r=xe(F(Ye,g),async h=>{var k,T,L;if(h.exists()){const R=h.data();p.value={name:R.name,users:R.users||[],private:(k=R.private)!=null?k:!0,latestMessage:R.latestMessageText&&R.latestMessageTimestamp?{text:R.latestMessageText,timestamp:R.latestMessageTimestamp}:void 0},((T=R.users)==null?void 0:T.length)!==((L=n.value)==null?void 0:L.length)&&await s()}a.value=!1},h=>{console.error("Error fetching room:",h),a.value=!1})},i=g=>{const h=g.toDate();return h.toLocaleDateString()===new Date().toLocaleDateString()?h.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):h.toLocaleString([],{hour:"2-digit",minute:"2-digit"})},u=(g,h=t.maxLength)=>g.length<=h?g:g.substring(0,h)+"...",m=w(!1),q=async g=>{g.stopPropagation(),m.value=!0},x=async()=>{if(!!t.id)try{await l(),o.currentRoute.value.params.id===t.id&&await o.push("/chats")}catch(g){console.error("Failed to leave room:",g)}};return tt(async()=>{await d(t.id)}),ot(()=>{r&&r()}),(g,h)=>(_(),$(K,null,[A((_(),E(ke,{clickable:"",onClick:h[0]||(h[0]=k=>De(o).push(`/chat/${t.id}`))},{default:y(()=>[c(Te,null,{default:y(()=>{var k,T,L;return[a.value?(_(),$("div",ro,[c(ae,{type:"text",width:"100px"}),c(ae,{type:"text",width:"50px"})])):(_(),$("div",uo,[S("div",co,[S("div",mo,he((k=p.value)==null?void 0:k.name),1),t.icons?(_(),E(Je,{key:0,name:(T=p.value)!=null&&T.private?"lock":"public"},null,8,["name"])):Lt("",!0)]),S("div",fo,[(L=p.value)!=null&&L.latestMessage?(_(),$(K,{key:0},[Ve(he(u(p.value.latestMessage.text))+" \xB7 "+he(i(p.value.latestMessage.timestamp)),1)],64)):(_(),$(K,{key:1},[Ve("No messages yet")],64))])]))]}),_:1}),c(Te,{side:""},{default:y(()=>[S("div",vo,[c(Ut,{users:De(n),left:""},null,8,["users"]),c(M,{icon:"logout",flat:"",round:"",class:"q-ml-md",onClick:q,color:"negative"})])]),_:1})]),_:1})),[[ft]]),c(io,{modelValue:m.value,"onUpdate:modelValue":h[1]||(h[1]=k=>m.value=k),onConfirm:x},null,8,["modelValue"])],64))}}),go={class:"col"},We=J({__name:"ChatList",props:{private:{default:!1,type:Boolean},public:{default:!1,type:Boolean}},setup(e){const o=e,t=w(!0),l=w([]),n=w([]);let s=null,a=null;const p=async()=>{var i;!((i=Fe.value)!=null&&i.uid)||(s=xe(F(j,"users",Fe.value.uid),async u=>{var x;const q=(((x=u.data())==null?void 0:x.rooms)||[]).map(g=>Re(F(j,"chatrooms",g)));Promise.all(q).then(g=>{g.forEach(h=>{var T;const k=h.data();k!=null&&k.private&&l.value.push({id:h.id,lastMessageTime:((T=k==null?void 0:k.lastMessageTime)==null?void 0:T.toMillis())||0})})})}))},r=async()=>{const i=ht(Ye,bt("private","==",!1));a=xe(i,async u=>{const m=u.docs.map(q=>{var g;const x=q.data();return{id:q.id,lastMessageTime:((g=x==null?void 0:x.lastMessageTime)==null?void 0:g.toMillis())||0}});n.value=m})},d=b(()=>{const i=new Set(l.value.map(m=>m.id)),u=n.value.filter(m=>!i.has(m.id));return[...l.value,...u].sort((m,q)=>q.lastMessageTime-m.lastMessageTime)});return tt(async()=>{o.public&&!o.private?await r():o.private&&!o.public?await p():(await r(),await p()),t.value=!1}),ot(()=>{s==null||s(),a==null||a()}),(i,u)=>(_(),E(Vt,{class:"rounded-borders",bordered:"",separator:""},{default:y(()=>[t.value?(_(),E(ke,{key:0},{default:y(()=>[S("div",go,[c(ae,{type:"rect",width:"250px"}),c(ae,{type:"text",width:"200px"})])]),_:1})):(_(),$(K,{key:1},[!t.value&&(o.private?l.value.length:o.public?n.value.length:d.value.length)===0?(_(),E(ke,{key:0},{default:y(()=>[c(Te,null,{default:y(()=>u[0]||(u[0]=[Ve("No chatrooms available.")])),_:1})]),_:1})):(_(!0),$(K,{key:1},Bt(o.public?n.value:o.private?l.value:d.value,m=>(_(),E(po,{key:m.id,id:m.id,"max-length":100},null,8,["id"]))),128))],64))]),_:1}))}}),ho=J({__name:"JoinRoomDialog",emits:["createRoom","joinRoom"],setup(e,{emit:o}){const t=o,l=w(!1),n=w(""),s=w(!1),a=w(!1),p=async i=>{if(!i){s.value=!1;return}a.value=!0;try{const u=await Re(F(j,"chatrooms",i));s.value=u.exists()}catch(u){console.error("Failed to check room:",u),s.value=!1}finally{a.value=!1}};let r;const d=()=>{s.value?t("joinRoom",n.value):t("createRoom",n.value)};return qe(n,i=>{clearTimeout(r),r=setTimeout(()=>{p(i)},500)}),(i,u)=>(_(),E(Le,{modelValue:l.value,"onUpdate:modelValue":u[1]||(u[1]=m=>l.value=m)},{default:y(()=>[c(Se,null,{default:y(()=>[c(ne,{class:"q-gutter-md"},{default:y(()=>[u[2]||(u[2]=S("div",{class:"text-h6"},"Join Room",-1)),c(_e,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=m=>n.value=m),label:"Room Code",outlined:"","stack-label":"",hint:!s.value&&n.value?"Room does not exist":""},null,8,["modelValue","hint"])]),_:1}),c(Ee,{align:"right"},{default:y(()=>[A(c(M,{flat:"",label:"Cancel"},null,512),[[W]]),A(c(M,{flat:"",label:s.value?"JOIN":"CREATE ROOM",onClick:d},null,8,["label"]),[[W]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});function bo(e,o){const t=w(null),l=b(()=>e.disable===!0?null:V("span",{ref:t,class:"no-outline",tabindex:-1}));function n(s){const a=o.value;s!==void 0&&s.type.indexOf("key")===0?a!==null&&document.activeElement!==a&&a.contains(document.activeElement)===!0&&a.focus():t.value!==null&&(s===void 0||a!==null&&a.contains(s.target)===!0)&&t.value.focus()}return{refocusTargetEl:l,refocusTarget:n}}var yo={xs:30,sm:35,md:40,lg:50,xl:60};const wo={...Jt,...gt,...Tt,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:e=>e==="tf"||e==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},xo=["update:modelValue"];function ko(e,o){const{props:t,slots:l,emit:n,proxy:s}=Ze(),{$q:a}=s,p=Wt(t,a),r=w(null),{refocusTargetEl:d,refocusTarget:i}=bo(t,r),u=vt(t,yo),m=b(()=>t.val!==void 0&&Array.isArray(t.modelValue)),q=b(()=>{const f=U(t.val);return m.value===!0?t.modelValue.findIndex(B=>U(B)===f):-1}),x=b(()=>m.value===!0?q.value!==-1:U(t.modelValue)===U(t.trueValue)),g=b(()=>m.value===!0?q.value===-1:U(t.modelValue)===U(t.falseValue)),h=b(()=>x.value===!1&&g.value===!1),k=b(()=>t.disable===!0?-1:t.tabindex||0),T=b(()=>`q-${e} cursor-pointer no-outline row inline no-wrap items-center`+(t.disable===!0?" disabled":"")+(p.value===!0?` q-${e}--dark`:"")+(t.dense===!0?` q-${e}--dense`:"")+(t.leftLabel===!0?" reverse":"")),L=b(()=>{const f=x.value===!0?"truthy":g.value===!0?"falsy":"indet",B=t.color!==void 0&&(t.keepColor===!0||(e==="toggle"?x.value===!0:g.value!==!0))?` text-${t.color}`:"";return`q-${e}__inner relative-position non-selectable q-${e}__inner--${f}${B}`}),R=b(()=>{const f={type:"checkbox"};return t.name!==void 0&&Object.assign(f,{".checked":x.value,"^checked":x.value===!0?"checked":void 0,name:t.name,value:m.value===!0?t.val:t.trueValue}),f}),ee=Rt(R),re=b(()=>{const f={tabindex:k.value,role:e==="toggle"?"switch":"checkbox","aria-label":t.label,"aria-checked":h.value===!0?"mixed":x.value===!0?"true":"false"};return t.disable===!0&&(f["aria-disabled"]="true"),f});function Y(f){f!==void 0&&(Ce(f),i(f)),t.disable!==!0&&n("update:modelValue",H(),f)}function H(){if(m.value===!0){if(x.value===!0){const f=t.modelValue.slice();return f.splice(q.value,1),f}return t.modelValue.concat([t.val])}if(x.value===!0){if(t.toggleOrder!=="ft"||t.toggleIndeterminate===!1)return t.falseValue}else if(g.value===!0){if(t.toggleOrder==="ft"||t.toggleIndeterminate===!1)return t.trueValue}else return t.toggleOrder!=="ft"?t.trueValue:t.falseValue;return t.indeterminateValue}function ue(f){(f.keyCode===13||f.keyCode===32)&&Ce(f)}function de(f){(f.keyCode===13||f.keyCode===32)&&Y(f)}const ce=o(x,h);return Object.assign(s,{toggle:Y}),()=>{const f=ce();t.disable!==!0&&ee(f,"unshift",` q-${e}__native absolute q-ma-none q-pa-none`);const B=[V("div",{class:L.value,style:u.value,"aria-hidden":"true"},f)];d.value!==null&&B.push(d.value);const te=t.label!==void 0?pt(l.default,[t.label]):se(l.default);return te!==void 0&&B.push(V("div",{class:`q-${e}__label q-anchor--skip`},te)),V("div",{ref:r,class:T.value,...re.value,onClick:Y,onKeydown:ue,onKeyup:de},B)}}var _o=ie({name:"QToggle",props:{...wo,icon:String,iconColor:String},emits:xo,setup(e){function o(t,l){const n=b(()=>(t.value===!0?e.checkedIcon:l.value===!0?e.indeterminateIcon:e.uncheckedIcon)||e.icon),s=b(()=>t.value===!0?e.iconColor:null);return()=>[V("div",{class:"q-toggle__track"}),V("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},n.value!==void 0?[V(Je,{name:n.value,color:s.value})]:void 0)]}return ko("toggle",o)}});const Co=J({__name:"CreateRoomDialog",emits:["update:roomCode","createRoom"],setup(e,{emit:o}){const t=w(""),l=w(""),n=w(!1),s=w(!1),a=o;return(p,r)=>(_(),E(Le,{modelValue:s.value,"onUpdate:modelValue":r[5]||(r[5]=d=>s.value=d)},{default:y(()=>[c(Se,null,{default:y(()=>[c(ne,{class:"q-gutter-md"},{default:y(()=>[r[6]||(r[6]=S("div",{class:"text-h6"},"Create Room",-1)),c(_e,{modelValue:t.value,"onUpdate:modelValue":[r[0]||(r[0]=d=>t.value=d),r[1]||(r[1]=d=>p.$emit("update:roomCode",d))],label:"Room Code","stack-label":""},null,8,["modelValue"]),c(_e,{modelValue:l.value,"onUpdate:modelValue":r[2]||(r[2]=d=>l.value=d),label:"Room Name","stack-label":""},null,8,["modelValue"]),c(_o,{modelValue:n.value,"onUpdate:modelValue":r[3]||(r[3]=d=>n.value=d),label:"Private Room"},null,8,["modelValue"])]),_:1}),c(Ee,{align:"right"},{default:y(()=>[A(c(M,{flat:"",label:"Cancel"},null,512),[[W]]),A(c(M,{flat:"",label:"Create",onClick:r[4]||(r[4]=d=>a("createRoom",t.value,l.value,n.value))},null,512),[[W]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),qo={class:"q-pa-md q-gutter-md"},Vo={class:"flex justify-between items-center"},Io=J({__name:"ChatroomsPage",setup(e){const{currentUser:o}=Nt(),t=w(!1),l=w(!1),n=w(""),s=et(),a=async d=>{try{const i=await Re(F(j,"chatrooms",d));if(i.exists()){const u=i.id;await s.push(`/chat/${u}`)}}catch(i){console.error("Failed to join room:",i)}},p=d=>{n.value=d,t.value=!1,$t(()=>{l.value=!0})},r=async(d,i,u)=>{if(!!o.value)try{const m=F(j,"chatrooms",d);await yt(m,{name:i,private:u,users:[o.value.uid],createdAt:wt()}),await xt(F(j,"users",o.value.uid),{rooms:kt(m.id)}),l.value=!1,await s.push(`/chat/${m.id}`)}catch(m){console.error("Failed to create room:",m)}};return(d,i)=>(_(),$(K,null,[S("div",qo,[S("div",Vo,[i[3]||(i[3]=S("div",{class:"text-h5 text-weight-bold"},"Your Chatrooms",-1)),c(M,{icon:"add",color:"pink-5",size:"sm",round:"",onClick:i[0]||(i[0]=u=>t.value=!0)})]),(_(),E(Ie,null,{default:y(()=>[c(We,{private:""})]),_:1})),i[4]||(i[4]=S("div",{class:"text-h6 text-weight-bold"},"Public chatrooms",-1)),(_(),E(Ie,null,{default:y(()=>[c(We,{public:""})]),_:1}))]),c(ho,{modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=u=>t.value=u),onJoinRoom:a,onCreateRoom:p},null,8,["modelValue"]),c(Co,{modelValue:l.value,"onUpdate:modelValue":i[2]||(i[2]=u=>l.value=u),"room-code":n.value,onCreateRoom:r},null,8,["modelValue","room-code"])],64))}});export{Io as default};
